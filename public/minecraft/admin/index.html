<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin Tool Box</title>
    <link rel="icon" href="/minecraft/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="root">
        <div class=admin-shell>
            <header>
                Admin Tools
                <button class="add-tool" id="add-tool">Add Tool</button>
            </header>
            <div class=tools-area>
                <div class="tool-grid" , id="tool-box">
                    <div class="tool-card">
                        <div class="tool-title">Reset Password</div>
                        <div class="tool-body">
                            <div>
                                <label>Mc Username</label>
                                <input type="text" data-key="mcusername">
                            </div>
                            <div>
                                <label>New Password</label>
                                <input type="text" data-key="password">
                            </div>
                        </div>
                        <button class="submit-btn" style="margin-top:8px">Submit</button>
                        <div class="card-actions">
                            <button class="edit">Edit</button>
                            <button class="remove">Remove</button>
                        </div>
                        <div class="card-message">Return Message</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div id="confirm-overlay" style="display: none;">
        <div id="confirm-card">
            <div class="confirm-title">Are you sure?</div>
            <div class="confirm-body">
                <div style="margin-bottom: 8px;">You are about to run <strong>Reset Password</strong> with the following
                    inputs:</div>
                <div><strong>mcusername:</strong> 5hk_</div>
                <div><strong>newPassword:</strong> 'h4cPmTGA+VAVa7</div>
                <div style="margin-top:8px;">Confirm to proceed</div>
            </div>
            <div class="confirm-actions">
                <button id="confirmNo">Cancel</button>
                <button id="confirmYes">Confirm</button>
            </div>
        </div>
    </div>

    <script>
        const ElConfirmOverlay = document.getElementById('confirm-overlay');
        function showConfirmOverlay() {
            ElConfirmOverlay.style.display = 'flex';
        }

        function hideConfirmOverlay() {
            ElConfirmOverlay.style.display = 'none';
        }

        //temp cancel button click event
        const ElConfirmOverlayCancel = document.getElementById('confirmNo');
        ElConfirmOverlayCancel.addEventListener('click', function (event) {
            event.preventDefault();
            hideConfirmOverlay();
        });

        //temp cancel button click event
        const ElAddTool = document.getElementById('add-tool');
        ElAddTool.addEventListener('click', function (event) {
            addUITool({
                name: "test name",
                inputs: [
                    {
                        key: "testkey",
                        label: "test input",
                        type: "text"
                    }
                ],
                action: "testfunction"
            });
        });

        const ToolBox = document.getElementById('tool-box')
        function addUITool(tool) {
            const card = document.createElement('div'); card.className = 'tool-card';
            const title = document.createElement('div'); title.className = 'tool-title'; title.textContent = tool.name;
            const body = document.createElement('div'); body.className = 'tool-body';
            const inputEls = {}; // map of key->element for reading values later

            // Build the input fields for the tool based on its inputs definition
            (tool.inputs || []).forEach(inp => {
                const fieldWrap = document.createElement('div');
                const label = document.createElement('label'); label.textContent = inp.label || inp.key;
                fieldWrap.appendChild(label);
                let el;
                // support textarea, select and default to <input>
                if (inp.type === 'textarea') {
                    el = document.createElement('textarea')
                } else if (inp.type === 'select') {
                    el = document.createElement('select');
                    (inp.options || []).forEach(o => { const opt = document.createElement('option'); opt.value = o.value; opt.textContent = o.label; el.appendChild(opt); });
                } else { el = document.createElement('input'); el.type = inp.type || 'text' }
                el.placeholder = inp.placeholder || '';
                el.dataset.key = inp.key;
                // Clear any card message when user edits fields (simple UX nicety)
                el.addEventListener('input', () => { const msg = card.querySelector('.card-message'); if (msg) msg.textContent = ''; });
                fieldWrap.appendChild(el);

                body.appendChild(fieldWrap);
                inputEls[inp.key] = el;
            });

            card.appendChild(title);
            card.appendChild(body);

            // Submit button triggers onSubmit which shows confirm overlay
            const submit = document.createElement('button'); submit.className = 'submit-btn'; submit.textContent = 'Submit';
            submit.addEventListener('click', () => onSubmit(tool, inputEls, card));
            card.appendChild(submit);

            // New: action buttons (Edit / Remove)
            const actions = document.createElement('div'); actions.className = 'card-actions';
            const editBtn = document.createElement('button'); editBtn.className = 'edit'; editBtn.textContent = 'Edit';
            const removeBtn = document.createElement('button'); removeBtn.className = 'remove'; removeBtn.textContent = 'Remove';

            // Wire the buttons to call globally-exposed handlers if present, otherwise default local handlers.
            // Temporary
            editBtn.addEventListener('click', () => {

            });

            // Temporary
            removeBtn.addEventListener('click', () => {
                event.preventDefault();
                showConfirmOverlay();
            });

            actions.appendChild(editBtn); actions.appendChild(removeBtn);
            card.appendChild(actions);

            const msg = document.createElement('div'); msg.className = 'card-message'; card.appendChild(msg);

            ToolBox.appendChild(card);
        }

        // Temporary
        function onSubmit() {
            showConfirmOverlay();
        }
    </script>
</body>

</html>